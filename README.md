# ChoraleGPT Preprocessing

A data preprocessing pipeline for Bach chorales to train language models on musical sequences.

## Overview

This project converts Bach chorales in MuscXML data into tokens suitable for machine learning models.


## Usage

  bin/inputXml [source] {OPTIONS}

    This program extracts parts from a music xml file and outputs a line of tokens for each part. It 
    transposes the chorale to C Major or A Minor and normalizes the meter to present eight-subdivisions
    (sub-beats) per beat.

  OPTIONS:

      -h, --help                        Display this help menu
      source                            The file name or url to process
      -s, --soprano                     Parse the soprano part
      -1, --soprano1                    Parse the soprano 1 part
      -2, --soprano2                    Parse the soprano 2 part
      -a, --alto                        Parse the alto part
      -t, --tenor                       Parse the tenor part
      -b, --bass                        Parse the bass part
      -v, --verbose                     Verbose output
      -f[output], --file=[output]       Output file path

'source' can be a musixml file, a url to a musixml file, or a txt file containing a list of filenames
or urls.




  bin/inputEncodings [source] {OPTIONS}

    This program reads the tokens generated by the inputXml program and combines all the parts
    into a single stream of tokens, using chords instead of individual notes. These tokens
    can then be used to train a transformer model.

  OPTIONS:

      -h, --help                        Display this help menu
      source                            The file name to process
      -v, --verbose                     Verbose output
      --noEOM                           Don't generate end-of-measure markers
      -f[output], --file=[output]       Output file path

## Output format

### Header
    [ID: <id of chorale>, PART: <name of part>, KEY: <key and mode>, BEATS: <beats per measure>, 
        SUB-BEATS: <sub-beats per beat>] 

### Marker tokens   
    [SOC] Start of chorale
    [EOM] End of measure
    [EOP] End of phrase
    [EOC] End of chorale
        
### Tokens generated by InputXml
    <pitch>.<octave>.<duration>   

    'pitch' consists of a letter (A-G, or R for a rest) and, optionally, a number indicating an alteration, 
        specified as the number of half steps above or below the pitch. It may also be pre-pendedy with a '+',
        indicating a tie from the previous note.
    'octave' 4 starts with middle C
    'duration' is the number of sub-beats the note should be held.
    
### Tokens generated by InputEncodings     
    <pitch>.<octave>.<pitch>.<octave>.<pitch>.<octave>.<pitch>.<octave>.<duration> 

    The token conists of 4 pitches, one for each part, starting with soprano, and a single
        duration. Each chord contains all four parts, with ties from the previous note
        for a given part if necessary.